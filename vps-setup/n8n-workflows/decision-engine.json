{
  "name": "SOAR Decision Engine Workflow",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "trigger-decision",
        "authentication": "none",
        "options": {}
      },
      "id": "decision-trigger",
      "name": "Decision Trigger",
      "type": "n8n-nodes-base.webhook",
      "position": [240, 300]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "event_type",
              "value": "={{ $node[\"Decision Trigger\"].json.event_type }}"
            },
            {
              "name": "severity",
              "value": "={{ $node[\"Decision Trigger\"].json.severity }}"
            }
          ]
        }
      },
      "id": "extract-decision-data",
      "name": "Extract Decision Data",
      "type": "n8n-nodes-base.set",
      "position": [460, 300]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $node[\"Extract Decision Data\"].json.severity }}",
              "operation": "greaterThan",
              "value2": 7
            }
          ]
        }
      },
      "id": "high-severity-check",
      "name": "High Severity Check",
      "type": "n8n-nodes-base.if",
      "position": [680, 200]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $node[\"Extract Decision Data\"].json.event_type }}",
              "operation": "equal",
              "value2": "ssh_bruteforce"
            }
          ]
        }
      },
      "id": "ssh-brute-rule",
      "name": "SSH Brute Force Rule",
      "type": "n8n-nodes-base.if",
      "position": [680, 400]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "response_action",
              "value": "block_ip"
            },
            {
              "name": "command",
              "value": "/usr/local/bin/soar-action apply_firewall_block {{ $node[\"Decision Trigger\"].json.source_ip }}"
            }
          ]
        }
      },
      "id": "queue-block-response",
      "name": "Queue Block IP Response",
      "type": "n8n-nodes-base.set",
      "position": [900, 200]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "response_action",
              "value": "restart_sshd"
            },
            {
              "name": "command",
              "value": "/usr/local/bin/soar-action restart_service sshd"
            }
          ]
        }
      },
      "id": "queue-restart-response",
      "name": "Queue Restart SSH Response",
      "type": "n8n-nodes-base.set",
      "position": [900, 400]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "response_action",
              "value": "manual_review"
            }
          ]
        }
      },
      "id": "queue-manual-review",
      "name": "Queue Manual Review",
      "type": "n8n-nodes-base.set",
      "position": [1120, 300]
    },
    {
      "parameters": {
        "workflowId": "response-dispatch-workflow-id"
      },
      "id": "trigger-dispatch",
      "name": "Trigger Response Dispatch",
      "type": "n8n-nodes-base.workflowTrigger",
      "position": [1340, 300]
    }
  ],
  "connections": {
    "Decision Trigger": {
      "main": [
        [
          {
            "node": "Extract Decision Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Decision Data": {
      "main": [
        [
          {
            "node": "High Severity Check",
            "type": "main",
            "index": 0
          },
          {
            "node": "SSH Brute Force Rule",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "High Severity Check": {
      "main": [
        [
          {
            "node": "Queue Block IP Response",
            "type": "main",
            "index": 0
          },
          {
            "node": "Queue Manual Review",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "SSH Brute Force Rule": {
      "main": [
        [
          {
            "node": "Queue Restart SSH Response",
            "type": "main",
            "index": 0
          },
          {
            "node": "Queue Manual Review",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Queue Block IP Response": {
      "main": [
        [
          {
            "node": "Trigger Response Dispatch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Queue Restart SSH Response": {
      "main": [
        [
          {
            "node": "Trigger Response Dispatch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Queue Manual Review": {
      "main": [
        [
          {
            "node": "Send Email Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {},
  "staticData": null
}